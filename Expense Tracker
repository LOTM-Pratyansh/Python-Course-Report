import json
from datetime import datetime

DATA_FILE = "expenses.json"

# Load existing data
def load_data():
    try:
        with open(DATA_FILE, "r") as f:
            return json.load(f)
    except FileNotFoundError:
        return []

# Save data
def save_data(data):
    with open(DATA_FILE, "w") as f:
        json.dump(data, f, indent=4)

# Add expense
def add_expense(expenses):
    category = input("Enter category (Food/Transport/Other): ")
    amount = float(input("Enter amount: "))
    date = input("Enter date (YYYY-MM-DD) or leave blank for today: ")
    if not date:
        date = str(datetime.today().date())
    
    expenses.append({"category": category, "amount": amount, "date": date})
    save_data(expenses)
    print("âœ… Expense added!")

# View expenses
def view_expenses(expenses):
    if not expenses:
        print("No expenses yet!")
        return
    print("\n--- All Expenses ---")
    for e in expenses:
        print(f"{e['date']} | {e['category']} | â‚¹{e['amount']}")
    print("--------------------")

# View by category
def view_by_category(expenses):
    cat = input("Enter category: ")
    filtered = [e for e in expenses if e["category"].lower() == cat.lower()]
    if not filtered:
        print("No expenses in this category.")
    else:
        for e in filtered:
            print(f"{e['date']} | â‚¹{e['amount']}")

# Monthly summary
def monthly_summary(expenses):
    month = input("Enter month (YYYY-MM): ")
    total = sum(e["amount"] for e in expenses if e["date"].startswith(month))
    print(f"ðŸ’° Total spent in {month}: â‚¹{total}")

# Main menu
def main():
    expenses = load_data()
    while True:
        print("\n--- Expense Tracker ---")
        print("1. Add Expense")
        print("2. View All Expenses")
        print("3. View by Category")
        print("4. Monthly Summary")
        print("5. Exit")
        choice = input("Choose an option: ")

        if choice == "1":
            add_expense(expenses)
        elif choice == "2":
            view_expenses(expenses)
        elif choice == "3":
            view_by_category(expenses)
        elif choice == "4":
            monthly_summary(expenses)
        elif choice == "5":
            print("Goodbye! ðŸ‘‹")
            break
        else:
            print("Invalid choice!")

if __name__ == "__main__":
    main()
